<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SmartPlaces.Facilities: Ontology Mapper</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SmartPlaces.Facilities
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_lib__ontology_mapper__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Ontology Mapper </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md16"></a>
Motivation and purpose</h1>
<p >The OntologyMapper allows developers to define conversion processes from one DTDL-based Ontology to a different DTDL-based Ontology.</p>
<p >This may be needed in cases where cloning a topology which uses a propriety ontology, and converting to an open standard ontology such as RealEstateCore.</p>
<p >These conversion rules are defined in a series of Mappings files here in the repo which are embedded in the assembly to make versioning easier.</p>
<p >The key is that these files describe exceptions only. If the source DTMI and Target DTMI are identical, nothing needs to appear for the mapping between the two. Thus, if an source and target use the same ontology and version, the mapping file will have very little content.</p>
<p >This library provides helpers useful for mapping one Digital Twins Definition Language (DTDL) model to a different DTDL model. It defines a set of classes which allow the following types to be mapped:</p>
<ol type="1">
<li>Interfaces</li>
</ol>
<ol type="1">
<li>Relationships</li>
</ol>
<ol type="1">
<li>Property Projections</li>
</ol>
<ol type="1">
<li>Backfilling of Properties</li>
</ol>
<p >A json file can be created with collections of these types of mappings, and then that can be used in a process which uses one DTDL ontology as an input and outputs a different DTDL ontology.</p>
<h1><a class="anchor" id="autotoc_md17"></a>
File Sections</h1>
<h2><a class="anchor" id="autotoc_md18"></a>
Header</h2>
<p >The header section is for informational purposes designating the source and destination DTDLs. This is to provide an at-a-glance summary of what DTDLs this file maps.</p>
<p ><b>Input Ontologies</b></p>
<p >A collection of what ontologies make up the input source for the conversion</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Name   </td><td class="markdownTableBodyNone">The name of the ontology    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Version   </td><td class="markdownTableBodyNone">The version of the ontology    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">DtdlVersion   </td><td class="markdownTableBodyNone">Which version of the DTDL language is currently in use for this provider   </td></tr>
</table>
<p ><b>Output Ontologies</b></p>
<p >A collection of what ontologies make up the output source for the conversion</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Name   </td><td class="markdownTableBodyNone">The name of the ontology    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Version   </td><td class="markdownTableBodyNone">The version of the ontology    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">DtdlVersion   </td><td class="markdownTableBodyNone">Which version of the DTDL language is currently in use for this provider   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md19"></a>
NamespaceRemaps</h2>
<p >A collection of mappings from one namespace name to another namespace name. This is used after the explicit InterfaceRemaps to execute a simple search and replace of a string in an input model to convert it to an output model. That is, in those cases where the input model interface name is exactly the same as the output model interface name, but the namespace is different, then the input model''s namespace will be replaced by the NamespaceRemap's output namespace.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">InputNamespace   </td><td class="markdownTableBodyNone">The string to search for in the input dtmi    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OutputNamespace   </td><td class="markdownTableBodyNone">The replacement string   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md20"></a>
InterfaceRemaps</h2>
<p >A collection of mappings from one interface name to another interface name. It is suggested that you only need to list mappings where the input DTMI is not the same as the output DTMI. Systems should assume that if a DTMI is not listed in the mappings, that the output DTMI will be the same as the input DTMI.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">InputDtmi   </td><td class="markdownTableBodyNone">The name of the input DTMI    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OutputDtmi   </td><td class="markdownTableBodyNone">The name of the output DTMI   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md21"></a>
RelationshipRemaps</h2>
<p >A collection of mappings from one relationship name to another relationship name. It is suggested that you only need to list mappings where the input relationship is not the same as the output relationship. Systems should assume that if a relationship is not listed in the mappings, that the output relationship will be the same as the input relationship.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">InputDtmi   </td><td class="markdownTableBodyNone">The name of the input relationship    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OutputDtmi   </td><td class="markdownTableBodyNone">The name of the output relationship    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ReverseRelationshipDirection   </td><td class="markdownTableBodyNone">The relationship direction can be reversed so that if the original relationship is from source to target, the new relationship will be from target to source   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md22"></a>
PropertyProjections</h2>
<p >A collection of mappings from one property name to another property name. It is suggested that you only need to list mappings where the input property is not the same as the output property. Systems should assume that if a property is not listed in the mappings, that the output property will be the same as the input property.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">OutputDtmiFilter   </td><td class="markdownTableBodyNone">A regex filter which allows filtering so that the mapping is only applied to output property names which match the filter. ".*" to apply to all output properties    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OutputPropertyName   </td><td class="markdownTableBodyNone">The name of the output property to assign the input property to    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">InputPropertyNames   </td><td class="markdownTableBodyNone">A collection of names of the input property to assign to the output property. Can only specify multiple input properties if the output property is a collection    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IsOutputPropertyCollection   </td><td class="markdownTableBodyNone">A flag which indicates whether or not the output property is a collection or not. This allows an input property which is not a collection to be assigned as an element in the output collection.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Priority   </td><td class="markdownTableBodyNone">If there are multiple projections for a single output property based on different DtmiFilters, priority is taken into account in ascending order   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md23"></a>
FillProperties</h2>
<p >A collection of mappings from one or more property names to another property name so that if the output property is a required value and the input fields might be empty, that alternative fields can be used to populate the output field. It is suggested that you only need to list mappings where the input property is not the same as the output property. Systems should assume that if a property is not listed in the mappings, that the output property will be the same as the input property. Implementations should respect the order in which the input properties are specified so that the first non-empty valued input property is assigned to the output property</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">OutputDtmiFilter   </td><td class="markdownTableBodyNone">A regex filter which allows filtering so that the mapping is only applied to output property names which match the filter. ".*" to apply to all output properties    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">OutputPropertyName   </td><td class="markdownTableBodyNone">The name of the output property to assign the input property to    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">InputPropertyNames   </td><td class="markdownTableBodyNone">A collection of names of the input property to assign to the output property. Can only specify multiple input properties if the output property is a collection    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Priority   </td><td class="markdownTableBodyNone">If there are multiple fillproperties for a single output property based on different DtmiFilters, priority is taken into account in ascending order   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md24"></a>
Sample File</h1>
<div class="fragment"><div class="line">  &quot;Header&quot;: {</div>
<div class="line">    &quot;InputOntologies&quot;: [</div>
<div class="line">      {</div>
<div class="line">        &quot;Name&quot;: &quot;input-ontology-name&quot;,</div>
<div class="line">        &quot;Version&quot;: &quot;1.0&quot;,</div>
<div class="line">        &quot;DtdlVersion&quot;: &quot;v2&quot;</div>
<div class="line">      }</div>
<div class="line">    ],</div>
<div class="line">    &quot;OutputOntologies&quot;: [</div>
<div class="line">      {</div>
<div class="line">        &quot;Name&quot;: &quot;output-ontology-name&quot;,</div>
<div class="line">        &quot;Version&quot;: &quot;2.0&quot;,</div>
<div class="line">        &quot;DtdlVersion&quot;: &quot;v3&quot;</div>
<div class="line">      }</div>
<div class="line">    ]</div>
<div class="line">  },</div>
<div class="line">  &quot;NamespaceRemaps&quot;: [</div>
<div class="line">    {</div>
<div class="line">      &quot;InputDtmi&quot;: &quot;dtmi:source-namespace:&quot;,</div>
<div class="line">      &quot;OutputDtmi&quot;: &quot;dtmi:target-namespace:&quot;</div>
<div class="line">    },</div>
<div class="line">  ],</div>
<div class="line">  &quot;InterfaceRemaps&quot;: [</div>
<div class="line">    {</div>
<div class="line">      &quot;InputDtmi&quot;: &quot;dtmi:source-namespace:source-interface-name;1&quot;,</div>
<div class="line">      &quot;OutputDtmi&quot;: &quot;dtmi:target-namespace:target-interface;1&quot;</div>
<div class="line">    },</div>
<div class="line">  ],</div>
<div class="line">  &quot;RelationshipRemaps&quot;: [</div>
<div class="line">    {</div>
<div class="line">      &quot;InputRelationship&quot;: &quot;source-relationship-name&quot;,</div>
<div class="line">      &quot;OutputRelationship&quot;: &quot;target-relationship-name&quot;</div>
<div class="line">      &quot;ReverseRelationshipDirection&quot;: true | false</div>
<div class="line">    }</div>
<div class="line">  ],</div>
<div class="line">  &quot;PropertyProjections&quot;: [</div>
<div class="line">    {</div>
<div class="line">      &quot;OutputDtmiFilter&quot;: &quot;.*&quot;,</div>
<div class="line">      &quot;OutputPropertyName&quot;: &quot;output-property-name&quot;,</div>
<div class="line">      &quot;InputPropertyNames&quot;: [ &quot;input-property-name1&quot;, &quot;input-property-name2&quot; ],</div>
<div class="line">      &quot;IsOutputPropertyCollection&quot;: true</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">      &quot;OutputDtmiFilter&quot;: &quot;\w*Space\w*&quot;,</div>
<div class="line">      &quot;OutputPropertyName&quot;: &quot;output-property-name&quot;,</div>
<div class="line">      &quot;InputPropertyNames&quot;: [ &quot;input-property-name2&quot; ],</div>
<div class="line">      &quot;IsOutputPropertyCollection&quot;: true</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  ],</div>
<div class="line">  &quot;FillProperties&quot;: [</div>
<div class="line">    {</div>
<div class="line">      &quot;OutputDtmiFilter&quot;: &quot;.*&quot;,</div>
<div class="line">      &quot;OutputPropertyName&quot;: &quot;output-property-name&quot;,</div>
<div class="line">      &quot;InputPropertyNames&quot;: [ &quot;input-property-name1, input-property-name2&quot; ]</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">      &quot;OutputDtmiFilter&quot;: &quot;\w*Space\w*&quot;,</div>
<div class="line">      &quot;OutputPropertyName&quot;: &quot;output-property-name&quot;,</div>
<div class="line">      &quot;InputPropertyNames&quot;: [ &quot;input-property-name2, input-property-name1&quot; ]</div>
<div class="line">    }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md25"></a>
Interfaces and Classes</h1>
<h2><a class="anchor" id="autotoc_md26"></a>
Interface: IOntologyMappingManager</h2>
<p ><b>Method: ValidateTargetOntologyMapping</b></p>
<p ><em>Description</em></p>
<p >Validates that all Output DTMIs listed in the Interface Remaps exist in the target object model</p>
<p ><em>Parameters</em></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">targetObjectModel   </td><td class="markdownTableBodyNone">A dictionary of DTMI to DTEntityInfo mappings which are valid in the target ontology    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">invalidTargets   </td><td class="markdownTableBodyNone">An output listing of invalid output mappings in the InterfaceRemaps   </td></tr>
</table>
<p ><em>Returns</em></p>
<p ><code>true</code> if all targets are valid, otherwise <code>false</code></p>
<p ><b>Method: TryGetInterfaceRemapDtmi</b></p>
<p ><em>Description</em></p>
<p >For a given DTMI from the source ontology, get the DTMI for the target ontology</p>
<p ><em>Parameters</em></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">inputDtmi   </td><td class="markdownTableBodyNone">The DTMI from the source ontology    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">dtmiRemap   </td><td class="markdownTableBodyNone">An InterfaceRemap if it exists   </td></tr>
</table>
<p ><em>Returns</em></p>
<p ><code>true</code> if a remap exists, or if a namespaceremap exists for the namespace of the input dtmi, otherwise <code>false</code></p>
<p ><b>Method: TryGetRelationshipRemap</b></p>
<p ><em>Description</em></p>
<p >For a given relationship from the source ontology, get the relationship for the target ontology</p>
<p ><em>Parameters</em></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">inputRelationship   </td><td class="markdownTableBodyNone">The relationship from the source ontology    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">relationshipRemap   </td><td class="markdownTableBodyNone">A relationshipRemap if it exists   </td></tr>
</table>
<p ><em>Returns</em></p>
<p ><code>true</code> if a remap exists, otherwise <code>false</code></p>
<p ><b>Method: TryGetFillProperty</b></p>
<p ><em>Description</em></p>
<p >In some cases, the contents of one input property may need to be copied to multiple other fields in the target ontology. For instance, if the target ontology requires that the name field always be populated, but the source name field may be null and the description field be more reliable, a chain of fields can be set here so that there is a priority list of fields that will backfill the name field if the input name field is null.</p>
<p ><em>Parameters</em></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">outputDtmi   </td><td class="markdownTableBodyNone">The output dtmi to which this search will be applied    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">outputPropertyName   </td><td class="markdownTableBodyNone">The name of the output property    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">fillProperty   </td><td class="markdownTableBodyNone">A fillProperty if it exists   </td></tr>
</table>
<p ><em>Returns</em></p>
<p ><code>true</code> if a fillProperty exists, otherwise <code>false</code></p>
<p ><b>Method: TryGetPropertyProjection</b></p>
<p ><em>Description</em></p>
<p >In some cases, a property of the input model needs to be put into a different field or collection in the target model. A declaration can be made to map the input field to the appropriate output field</p>
<p ><em>Parameters</em></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">outputDtmi   </td><td class="markdownTableBodyNone">The output dtmi to which this search will be applied    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">outputPropertyName   </td><td class="markdownTableBodyNone">The name of the output property    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">propertyProjection   </td><td class="markdownTableBodyNone">The property projection for the output property   </td></tr>
</table>
<p ><em>Returns</em></p>
<p ><code>true</code> if a propertyProjection exists, otherwise <code>false</code></p>
<h2><a class="anchor" id="autotoc_md27"></a>
Interface: IOntologyMappingLoader</h2>
<p ><b>Method: LoadOntologyMapping</b></p>
<p ><em>Description</em></p>
<p >Loads an OntologyMapping into memory</p>
<p ><em>Parameters</em></p>
<p >None</p>
<p ><em>Returns</em></p>
<p >An ontology mapping</p>
<h2><a class="anchor" id="autotoc_md28"></a>
Class: FileOntologyMappingLoader</h2>
<p ><b>Implements</b></p>
<p >OntologyMapper.IOntologyMappingLoader</p>
<p ><b>Method: LoadOntologyMapping</b></p>
<p ><em>Description</em></p>
<p >Loads an OntologyMapping into memory from an input file (specified in the constructor)</p>
<p ><em>Parameters</em></p>
<p >None</p>
<p ><em>Returns</em></p>
<p >An ontology mapping </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
